In interest speed, it might be worthwhile to swap out the caTools package for the base64enc package for base 64 encoding.  Here's a speed comparison:```s> library(caTools)> library(base64enc)> > pngFile <- tempfile(fileext=".png")> png(file=pngFile, width=1000, height=1000)> plot(rnorm(10000))> dev.off()null device           1 > > bytes <- file.info(pngFile)$size> fileData <- readBin(pngFile, "raw", n = bytes)> > system.time(b64.cat <- caTools:::base64encode(fileData))   user  system elapsed   0.136   0.022   0.157 > system.time(b64.enc <- base64enc:::base64encode(fileData))   user  system elapsed   0.002   0.000   0.002 > > b64.cat == b64.enc[1] TRUE```The lag of caTools really adds up when rendering many plots on a page.
